<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‚¨çš„ä¸“å±æ—…æ¸¸è§„åˆ’ - æ™ºèƒ½æ—…æ¸¸è§„åˆ’åŠ©æ‰‹</title>
    <style>
        /* 
         * æ—…æ¸¸è§„åˆ’ç»“æœå±•ç¤ºé¡µé¢æ ·å¼
         * åŠŸèƒ½ï¼šå±•ç¤ºç”¨æˆ·çš„ä¸ªæ€§åŒ–æ—…æ¸¸è§„åˆ’ç»“æœ
         * åŒ…å«ç¾è§‚çš„ç»“æœå±•ç¤ºå’Œè¿”å›å¯¼èˆªåŠŸèƒ½
         */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 1000px;
            margin: 0 auto;
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f2f5;
        }

        .header h1 {
            font-size: 28px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .back-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .loading-container {
            text-align: center;
            padding: 60px 20px;
            display: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #666;
            font-size: 16px;
        }

        .error-container {
            text-align: center;
            padding: 60px 20px;
            display: none;
        }

        .error-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .error-text {
            color: #e74c3c;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .plan-overview {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .plan-overview h2 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .overview-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .overview-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .overview-value {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .plan-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f2f5;
        }

        .section-title {
            font-size: 20px;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f8f9fa;
        }

        .itinerary-day {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .day-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .day-content {
            color: #555;
            line-height: 1.6;
            margin-left: 15px;
        }

        .suggestions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .suggestion-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e9ecef;
            transition: transform 0.3s ease;
        }

        .suggestion-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .suggestion-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .suggestion-content {
            color: #555;
            line-height: 1.5;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        .action-btn {
            padding: 15px 30px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .header h1 {
                font-size: 24px;
            }

            .overview-grid {
                grid-template-columns: 1fr;
            }

            .suggestions-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .action-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }

        .icon {
            font-size: 18px;
        }
    </style>
</head>
<body>
    <!-- 
     * æ—…æ¸¸è§„åˆ’ç»“æœå±•ç¤ºé¡µé¢
     * åŠŸèƒ½ï¼šå±•ç¤ºæ™ºèƒ½ç”Ÿæˆçš„ä¸ªæ€§åŒ–æ—…æ¸¸è§„åˆ’
     * åŒ…å«è¡Œç¨‹æ¦‚è§ˆã€è¯¦ç»†è§„åˆ’ã€è´´å¿ƒå»ºè®®ç­‰å†…å®¹
     -->
    
    <div class="container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="header">
            <h1>
                <span class="icon">ğŸ“‹</span>
                æ‚¨çš„ä¸“å±æ—…æ¸¸è§„åˆ’
            </h1>
            <button class="back-btn" onclick="goBack()">
                <span class="icon">â¬…ï¸</span>
                è¿”å›é¦–é¡µ
            </button>
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div class="loading-container" id="loadingContainer">
            <div class="loading-spinner"></div>
            <div class="loading-text">æ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆä¸“å±æ—…æ¸¸è§„åˆ’...</div>
        </div>

        <!-- é”™è¯¯çŠ¶æ€ -->
        <div class="error-container" id="errorContainer">
            <div class="error-icon">âŒ</div>
            <div class="error-text">æŠ±æ­‰ï¼Œæœªæ‰¾åˆ°è§„åˆ’æ•°æ®</div>
            <button class="back-btn" onclick="goBack()">
                <span class="icon">â¬…ï¸</span>
                è¿”å›é‡æ–°è§„åˆ’
            </button>
        </div>

        <!-- è§„åˆ’å†…å®¹åŒºåŸŸ -->
        <div id="planContent" style="display: none;">
            <!-- è¡Œç¨‹æ¦‚è§ˆ -->
            <div class="plan-overview">
                <h2>
                    <span class="icon">ğŸ¯</span>
                    è¡Œç¨‹æ¦‚è§ˆ
                </h2>
                <div class="overview-grid" id="overviewGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆæ¦‚è§ˆä¿¡æ¯ -->
                </div>
            </div>

            <!-- è¯¦ç»†è¡Œç¨‹å®‰æ’ -->
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ“…</span>
                    è¯¦ç»†è¡Œç¨‹å®‰æ’
                </div>
                <div id="itineraryContent">
                    <!-- åŠ¨æ€ç”Ÿæˆè¡Œç¨‹å†…å®¹ -->
                </div>
            </div>

            <!-- è´´å¿ƒå»ºè®® -->
            <div class="plan-section">
                <div class="section-title">
                    <span class="icon">ğŸ’¡</span>
                    è´´å¿ƒå»ºè®®
                </div>
                <div class="suggestions-grid" id="suggestionsGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆå»ºè®®å†…å®¹ -->
                </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="action-buttons">
                <button class="action-btn btn-secondary" onclick="goBack()">
                    <span class="icon">â¬…ï¸</span>
                    é‡æ–°è§„åˆ’
                </button>
                <button class="action-btn btn-primary" onclick="savePlan()">
                    <span class="icon">ğŸ’¾</span>
                    ä¿å­˜è§„åˆ’
                </button>
                <button class="action-btn btn-primary" onclick="sharePlan()">
                    <span class="icon">ğŸ“±</span>
                    åˆ†äº«è§„åˆ’
                </button>
            </div>
        </div>
    </div>

    <script>
        /* 
         * æ—…æ¸¸è§„åˆ’ç»“æœé¡µé¢äº¤äº’è„šæœ¬
         * åŠŸèƒ½ï¼šåŠ è½½å¹¶å±•ç¤ºæ—…æ¸¸è§„åˆ’æ•°æ®ï¼Œå¤„ç†ç”¨æˆ·äº¤äº’
         */
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('æ—…æ¸¸è§„åˆ’ç»“æœé¡µé¢åŠ è½½å®Œæˆ');
            loadPlanData();
        });

        /**
         * åŠ è½½æ—…æ¸¸è§„åˆ’æ•°æ®
         * ä»localStorageè¯»å–è§„åˆ’æ•°æ®å¹¶ç”Ÿæˆæ™ºèƒ½æ—…æ¸¸æ”»ç•¥
         */
        async function loadPlanData() {
            const loadingContainer = document.getElementById('loadingContainer');
            const errorContainer = document.getElementById('errorContainer');
            const planContent = document.getElementById('planContent');
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            loadingContainer.style.display = 'block';
            
            try {
                // ä»localStorageè·å–è§„åˆ’æ•°æ®
                const planData = localStorage.getItem('travelPlanData');
                
                if (!planData) {
                    throw new Error('æœªæ‰¾åˆ°è§„åˆ’æ•°æ®');
                }
                
                const data = JSON.parse(planData);
                console.log('å¼€å§‹ç”Ÿæˆæ™ºèƒ½æ—…æ¸¸è§„åˆ’:', data);
                
                // ç”Ÿæˆæ™ºèƒ½æ—…æ¸¸æ”»ç•¥
                const intelligentPlan = await generateIntelligentPlan(data);
                
                // å°†æ™ºèƒ½è§„åˆ’æ•°æ®åˆå¹¶åˆ°åŸæ•°æ®ä¸­
                const completePlanData = { ...data, ...intelligentPlan };
                
                // æ¸²æŸ“è§„åˆ’å†…å®¹
                renderPlanContent(completePlanData);
                
                // éšè—åŠ è½½çŠ¶æ€ï¼Œæ˜¾ç¤ºå†…å®¹
                loadingContainer.style.display = 'none';
                planContent.style.display = 'block';
                
            } catch (error) {
                console.error('ç”Ÿæˆæ™ºèƒ½è§„åˆ’å¤±è´¥:', error);
                loadingContainer.style.display = 'none';
                errorContainer.style.display = 'block';
            }
        }

        /**
         * ç”Ÿæˆæ™ºèƒ½æ—…æ¸¸æ”»ç•¥
         * @param {Object} data - åŸºç¡€æ—…æ¸¸æ•°æ®
         * @returns {Object} æ™ºèƒ½è§„åˆ’æ•°æ®
         */
        async function generateIntelligentPlan(data) {
            const { departure, destination, duration, departureDate } = data;
            
            // æ›´æ–°åŠ è½½æç¤º
            document.querySelector('.loading-text').textContent = 'æ­£åœ¨æœç´¢ç›®çš„åœ°ä¿¡æ¯...';
            
            try {
                // å¹¶è¡Œè·å–å¤šç§ä¿¡æ¯
                const [attractionsInfo, transportInfo, weatherInfo, foodInfo] = await Promise.all([
                    searchAttractions(destination),
                    searchTransportation(departure, destination),
                    getWeatherInfo(destination),
                    searchLocalFood(destination)
                ]);
                
                console.log('è·å–çš„ä¿¡æ¯:', { attractionsInfo, transportInfo, weatherInfo, foodInfo });
                
                return {
                    attractions: attractionsInfo,
                    transportation: transportInfo,
                    weather: weatherInfo,
                    localFood: foodInfo,
                    detailedItinerary: generateDetailedItinerary(duration, attractionsInfo, foodInfo),
                    intelligentSuggestions: generateIntelligentSuggestions(attractionsInfo, weatherInfo, duration)
                };
                
            } catch (error) {
                console.error('ç”Ÿæˆæ™ºèƒ½è§„åˆ’æ—¶å‡ºé”™:', error);
                // è¿”å›é»˜è®¤è§„åˆ’
                return generateDefaultPlan(data);
            }
        }

        /**
         * æœç´¢æ™¯ç‚¹ä¿¡æ¯
         */
        async function searchAttractions(destination) {
            try {
                // ä½¿ç”¨é«˜å¾·åœ°å›¾APIæœç´¢æ™¯ç‚¹
                const response = await searchPlacesAPI(destination, 'æ—…æ¸¸æ™¯ç‚¹');
                
                if (response && response.pois && response.pois.length > 0) {
                    const attractions = response.pois.slice(0, 5);
                    return {
                        main: attractions.slice(0, 3).map(poi => poi.name),
                        secondary: attractions.slice(3).map(poi => poi.name),
                        description: `${destination}æ‹¥æœ‰${attractions.length}ä¸ªä¸»è¦æ—…æ¸¸æ™¯ç‚¹ï¼ŒåŒ…å«ä¸°å¯Œçš„å†å²æ–‡åŒ–å’Œè‡ªç„¶é£å…‰`
                    };
                } else {
                    // å¦‚æœAPIæœç´¢å¤±è´¥ï¼Œä½¿ç”¨ç½‘ç»œæœç´¢ä½œä¸ºå¤‡é€‰
                    return await webSearchAttractions(destination);
                }
            } catch (error) {
                console.error('æœç´¢æ™¯ç‚¹ä¿¡æ¯å¤±è´¥:', error);
                return await webSearchAttractions(destination);
            }
        }

        /**
         * ä½¿ç”¨ç½‘ç»œæœç´¢è·å–æ™¯ç‚¹ä¿¡æ¯ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰
         */
        async function webSearchAttractions(destination) {
            try {
                // ä½¿ç”¨å†…ç½®çš„æœç´¢å¼•æ“æœç´¢æ™¯ç‚¹ä¿¡æ¯
                const searchQuery = `${destination} æ—…æ¸¸æ™¯ç‚¹ æ”»ç•¥ å¿…å»æ™¯ç‚¹`;
                
                // æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨è™šæ‹Ÿçš„æœç´¢ï¼Œå®é™…åº”ç”¨ä¸­éœ€è¦é›†æˆçœŸå®çš„æœç´¢API
                // å¯ä»¥ä½¿ç”¨Google Search APIã€ç™¾åº¦æœç´¢APIç­‰
                
                const knownAttractions = getKnownAttractions(destination);
                
                return {
                    main: knownAttractions.main,
                    secondary: knownAttractions.secondary,
                    description: knownAttractions.description
                };
            } catch (error) {
                console.error('ç½‘ç»œæœç´¢æ™¯ç‚¹ä¿¡æ¯å¤±è´¥:', error);
                return {
                    main: [`${destination}ä¸»è¦æ™¯ç‚¹`],
                    secondary: [`${destination}å‘¨è¾¹æ™¯ç‚¹`],
                    description: `${destination}æ—…æ¸¸æ™¯ç‚¹ä¿¡æ¯`
                };
            }
        }

        /**
         * è°ƒç”¨åœ°å›¾APIæœç´¢åœ°ç‚¹
         */
        async function searchPlacesAPI(city, keywords) {
            try {
                // æ¨¡æ‹ŸAPIè°ƒç”¨ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„åœ°å›¾APIï¼‰
                // ç”±äºæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼ŒçœŸå®çš„APIè°ƒç”¨éœ€è¦åç«¯ä»£ç†
                
                console.log(`æœç´¢${city}çš„${keywords}`);
                
                // è¿”å›æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”ç”¨ä¸­åº”è¯¥è°ƒç”¨çœŸå®API
                return null;
                
            } catch (error) {
                console.error('åœ°å›¾APIè°ƒç”¨å¤±è´¥:', error);
                return null;
            }
        }

        /**
         * è·å–å·²çŸ¥æ™¯ç‚¹ä¿¡æ¯ï¼ˆç¦»çº¿æ•°æ®åº“ï¼‰
         */
        function getKnownAttractions(destination) {
            const attractionsDB = {
                'åŒ—äº¬': {
                    main: ['æ•…å®«åšç‰©é™¢', 'å¤©å®‰é—¨å¹¿åœº', 'é•¿åŸ'],
                    secondary: ['é¢å’Œå›­', 'å¤©å›'],
                    description: 'åŒ—äº¬æ˜¯ä¸­å›½çš„é¦–éƒ½ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„å†å²æ–‡åŒ–é—äº§å’Œç°ä»£éƒ½å¸‚é£è²Œ'
                },
                'ä¸Šæµ·': {
                    main: ['å¤–æ»©', 'ä¸œæ–¹æ˜ç ', 'å—äº¬è·¯'],
                    secondary: ['è±«å›­', 'ç”°å­åŠ'],
                    description: 'ä¸Šæµ·æ˜¯ä¸­å›½çš„ç»æµä¸­å¿ƒï¼Œèåˆäº†ä¼ ç»Ÿä¸ç°ä»£çš„ç‹¬ç‰¹é­…åŠ›'
                },
                'æ­å·': {
                    main: ['è¥¿æ¹–', 'é›·å³°å¡”', 'çµéšå¯º'],
                    secondary: ['åƒå²›æ¹–', 'è¥¿æºªæ¹¿åœ°'],
                    description: 'æ­å·ä»¥è¥¿æ¹–ç¾æ™¯é—»åå¤©ä¸‹ï¼Œæ˜¯æ±Ÿå—æ°´ä¹¡çš„å…¸å‹ä»£è¡¨'
                },
                'æˆéƒ½': {
                    main: ['å®½çª„å··å­', 'é”¦é‡Œ', 'å¤§ç†ŠçŒ«ç¹è‚²ç ”ç©¶åŸºåœ°'],
                    secondary: ['éƒ½æ±Ÿå °', 'é’åŸå±±'],
                    description: 'æˆéƒ½æ˜¯å¤©åºœä¹‹å›½çš„æ ¸å¿ƒï¼Œä»¥æ‚ é—²çš„ç”Ÿæ´»æ–¹å¼å’Œç¾é£Ÿæ–‡åŒ–è‘—ç§°'
                },
                'è¥¿å®‰': {
                    main: ['å…µé©¬ä¿‘', 'å¤§é›å¡”', 'å¤åŸå¢™'],
                    secondary: ['åæ¸…æ± ', 'æ³•é—¨å¯º'],
                    description: 'è¥¿å®‰æ˜¯åä¸‰æœå¤éƒ½ï¼Œæ‹¥æœ‰æ·±åšçš„å†å²æ–‡åŒ–åº•è•´'
                },
                'ä¸‰äºš': {
                    main: ['äºšé¾™æ¹¾', 'å¤©æ¶¯æµ·è§’', 'å—å±±å¯º'],
                    secondary: ['èœˆæ”¯æ´²å²›', 'å¤§ä¸œæµ·'],
                    description: 'ä¸‰äºšæ˜¯ä¸­å›½çš„çƒ­å¸¦æµ·æ»¨æ—…æ¸¸åŸå¸‚ï¼Œæ‹¥æœ‰ä¼˜ç¾çš„æµ·æ»©å’Œåº¦å‡ç¯å¢ƒ'
                },
                'æ¡‚æ—': {
                    main: ['æ¼“æ±Ÿ', 'è±¡é¼»å±±', 'é˜³æœ”'],
                    secondary: ['èŠ¦ç¬›å²©', 'ä¸ƒæ˜Ÿå…¬å›­'],
                    description: 'æ¡‚æ—å±±æ°´ç”²å¤©ä¸‹ï¼Œä»¥å–€æ–¯ç‰¹åœ°è²Œå’Œå±±æ°´é£å…‰é—»å'
                },
                'ä¸½æ±Ÿ': {
                    main: ['ä¸½æ±Ÿå¤åŸ', 'ç‰é¾™é›ªå±±', 'æ³¸æ²½æ¹–'],
                    secondary: ['æŸæ²³å¤é•‡', 'è™è·³å³¡'],
                    description: 'ä¸½æ±Ÿæ˜¯çº³è¥¿æ—æ–‡åŒ–çš„å‘æºåœ°ï¼Œæ‹¥æœ‰ç‹¬ç‰¹çš„å¤åŸé£è²Œå’Œè‡ªç„¶é£å…‰'
                },
                // å®‰å¾½çœåŸå¸‚
                'åˆè‚¥': {
                    main: ['åŒ…å…¬å›­', 'æé¸¿ç« æ•…å±…', 'ä¸‰æ²³å¤é•‡'],
                    secondary: ['å¤§èœ€å±±', 'å·¢æ¹–', 'å®‰å¾½åšç‰©é™¢'],
                    description: 'åˆè‚¥æ˜¯å®‰å¾½çœçœä¼šï¼Œæœ‰"æ±Ÿæ·®é¦–éƒ¡ã€å´æ¥šè¦å†²"ä¹‹ç§°'
                },
                'èŠœæ¹–': {
                    main: ['æ–¹ç‰¹æ¬¢ä¹ä¸–ç•Œ', 'é›•å¡‘å…¬å›­', 'é¸ å…¹å¤é•‡'],
                    secondary: ['èµ­å±±é£æ™¯åŒº', 'èŠœæ¹–é•¿æ±Ÿå¤§æ¡¥', 'å¤©é—¨å±±'],
                    description: 'èŠœæ¹–æ˜¯é•¿æ±Ÿæ°´è¿ç¬¬äº”å¤§æ¸¯ï¼Œæœ‰"æ±ŸåŸ"ä¹‹ç§°'
                },
                'é»„å±±': {
                    main: ['é»„å±±é£æ™¯åŒº', 'å®æ‘', 'è¥¿é€’'],
                    secondary: ['å¾½å·å¤åŸ', 'é½äº‘å±±', 'å‘ˆå'],
                    description: 'é»„å±±ä»¥å¥‡æ¾ã€æ€ªçŸ³ã€äº‘æµ·ã€æ¸©æ³‰è‘—ç§°ï¼Œæ˜¯ä¸–ç•Œæ–‡åŒ–ä¸è‡ªç„¶åŒé‡é—äº§'
                },
                'å®‰åº†': {
                    main: ['å¤©æŸ±å±±', 'è¿æ±Ÿå¯º', 'æŒ¯é£å¡”'],
                    secondary: ['å®‰åº†åšç‰©é¦†', 'è±æ¹–å…¬å›­', 'å¤§è§‚äº­'],
                    description: 'å®‰åº†æ˜¯å®‰å¾½çœæ›¾ç»çš„çœä¼šï¼Œæœ‰"ä¸‡é‡Œé•¿æ±Ÿæ­¤å°å–‰ï¼Œå´æ¥šåˆ†ç–†ç¬¬ä¸€å·"ä¹‹èª‰'
                },
                'æ± å·': {
                    main: ['ä¹åå±±', 'å¤§æ„¿æ–‡åŒ–å›­', 'èŠ±å°'],
                    secondary: ['å‡é‡‘æ¹–', 'ç‰¯ç‰›é™', 'çŸ³å°å¿'],
                    description: 'æ± å·æ˜¯ä¸­å›½ä½›æ•™å››å¤§åå±±ä¹‹ä¸€ä¹åå±±æ‰€åœ¨åœ°ï¼Œæœ‰"åƒè½½è¯—äººåœ°"ä¹‹èª‰'
                },
                'å…­å®‰': {
                    main: ['å¤©å ‚å¯¨', 'ä¸‡ä½›æ¹–', 'çš–è¥¿åšç‰©é¦†'],
                    secondary: ['å¤§åˆ«å±±', 'éœå±±', 'èˆ’åŸ'],
                    description: 'å…­å®‰åœ°å¤„å¤§åˆ«å±±åŒ—éº“ï¼Œæ˜¯è‘—åçš„é©å‘½è€åŒºå’Œç”Ÿæ€æ—…æ¸¸åŒº'
                },
                'å®£åŸ': {
                    main: ['æ•¬äº­å±±', 'è°¢æœ“æ¥¼', 'ä¸­å›½é³„é±¼æ¹–'],
                    secondary: ['å¤ªææ´', 'ç»©æºªé¾™å·', 'æ³¾å¿æ¡ƒèŠ±æ½­'],
                    description: 'å®£åŸæœ‰"æ±Ÿå—é€šéƒ½å¤§é‚‘"ä¹‹ç§°ï¼Œæ˜¯æ±Ÿå—æ–‡åŒ–çš„é‡è¦å‘æºåœ°'
                },
                'é“œé™µ': {
                    main: ['å¤©äº•æ¹–', 'å¤§é€šå¤é•‡', 'é“œæ–‡åŒ–åšç‰©é¦†'],
                    secondary: ['å‡¤å‡°å±±', 'é‡‘ç‰›æ´å¤é‡‡çŸ¿é—å€', 'å¤§æ˜å¯º'],
                    description: 'é“œé™µæ˜¯ä¸­å›½å¤ä»£é’é“œæ–‡åŒ–çš„å‘ç¥¥åœ°ä¹‹ä¸€ï¼Œæœ‰"ä¸­å›½å¤é“œéƒ½"ä¹‹ç§°'
                },
                'é©¬éå±±': {
                    main: ['é‡‡çŸ³çŸ¶', 'æ¿®å¡˜é£æ™¯åŒº', 'æœ±ç„¶å¢“åšç‰©é¦†'],
                    secondary: ['å¤ªç™½æ¥¼', 'ç”„å±±å¯º', 'é›¨å±±æ¹–'],
                    description: 'é©¬éå±±æœ‰"é’¢åŸ"ä¹‹ç§°ï¼Œé‡‡çŸ³çŸ¶ä¸º"é•¿æ±Ÿä¸‰çŸ¶"ä¹‹é¦–'
                },
                'æ·®å—': {
                    main: ['å…«å…¬å±±', 'é¾™æ¹–å…¬å›­', 'æ·®å—å­æ–‡åŒ–å›­'],
                    secondary: ['ç„¦å²—æ¹–', 'ä¸Šçª‘å±±', 'èŒ…ä»™æ´'],
                    description: 'æ·®å—æ˜¯è±†è…çš„å‘æ˜åœ°ï¼Œæœ‰"ä¸­å›½è±†è…ä¹‹ä¹¡"çš„ç¾èª‰'
                },
                'æ·®åŒ—': {
                    main: ['ç›¸å±±å…¬å›­', 'ä¸´æ¶£å¤åŸ', 'é¾™è„Šå±±'],
                    secondary: ['çƒˆå±±åŒº', 'å—æ¹–æ¹¿åœ°å…¬å›­', 'éš‹å”è¿æ²³å¤é•‡'],
                    description: 'æ·®åŒ—æ˜¯èƒ½æºä¹‹éƒ½ï¼Œæœ‰"ä¸­åŸç…¤åŸ"ä¹‹ç§°'
                },
                'èšŒåŸ ': {
                    main: ['å¼ å…¬å±±å…¬å›­', 'åŒå¢©æ–‡åŒ–é—å€', 'é¾™å­æ¹–'],
                    secondary: ['æ¶‚å±±é£æ™¯åŒº', 'ç™½ä¹³æ³‰', 'è†å±±'],
                    description: 'èšŒåŸ æœ‰"ç åŸ"ä¹‹ç§°ï¼Œæ˜¯æ·®æ²³æ–‡åŒ–çš„é‡è¦å‘æºåœ°'
                },
                'é˜œé˜³': {
                    main: ['æ–‡å³°å¡”', 'å¥æ˜Ÿæ¥¼', 'é¢å·è¥¿æ¹–'],
                    secondary: ['å…«é‡Œæ²³é£æ™¯åŒº', 'è¿ªæ²Ÿç”Ÿæ€ä¹å›­', 'å°¤å®¶èŠ±å›­'],
                    description: 'é˜œé˜³æœ‰"æ·®å³è¥Ÿå–‰ï¼Œæ±Ÿå—å±éšœ"ä¹‹ç§°ï¼Œæ˜¯çš–åŒ—é‡è¦åŸå¸‚'
                },
                'å®¿å·': {
                    main: ['çš‡è—å³ª', 'äº”æŸ³é£æ™¯åŒº', 'è™å§¬å¢“'],
                    secondary: ['å¥‡çŸ³æ–‡åŒ–å›­', 'å®¿å·åšç‰©é¦†', 'çµç’§çŸ³'],
                    description: 'å®¿å·æ˜¯æ¥šæ±‰æ–‡åŒ–ã€æ±‰æ–‡åŒ–çš„é‡è¦å‘æºåœ°ä¹‹ä¸€'
                },
                'äº³å·': {
                    main: ['èŠ±æˆæ¥¼', 'æ›¹æ“å…¬å›­', 'åç¥–åºµ'],
                    secondary: ['å¤äº•é…’æ–‡åŒ–åšè§ˆå›­', 'ç™½è¡£å¾‹é™¢', 'é“å¾·ä¸­å®«'],
                    description: 'äº³å·æ˜¯åä½—çš„æ•…ä¹¡ï¼Œä¸­åŒ»è¯æ–‡åŒ–çš„é‡è¦å‘æºåœ°'
                },
                'æ»å·': {
                    main: ['é†‰ç¿äº­', 'ç…çŠå±±', 'æ˜çš‡é™µ'],
                    secondary: ['æ¸…æµå…³', 'ç™½é¹­å²›', 'èŠ±å±±å½©è™¹ç€‘å¸ƒ'],
                    description: 'æ»å·æœ‰"é‡‘é™µé”é’¥ã€æ±Ÿæ·®ä¿éšœ"ä¹‹ç§°ï¼Œé†‰ç¿äº­äº«æœ‰ç››å'
                }
            };
            
            return attractionsDB[destination] || {
                main: [`${destination}ä¸»è¦æ™¯ç‚¹1`, `${destination}ä¸»è¦æ™¯ç‚¹2`, `${destination}ä¸»è¦æ™¯ç‚¹3`],
                secondary: [`${destination}ç‰¹è‰²æ™¯ç‚¹1`, `${destination}ç‰¹è‰²æ™¯ç‚¹2`],
                description: `${destination}æ‹¥æœ‰ä¸°å¯Œçš„æ—…æ¸¸èµ„æºå’Œæ–‡åŒ–åº•è•´`
            };
        }

        /**
         * æœç´¢äº¤é€šä¿¡æ¯
         */
        async function searchTransportation(departure, destination) {
            try {
                // è·å–å…·ä½“çš„äº¤é€šä¿¡æ¯
                const transportInfo = getTransportInfo(departure, destination);
                
                return {
                    flight: transportInfo.flight,
                    train: transportInfo.train,
                    bus: transportInfo.bus,
                    localTransport: transportInfo.localTransport
                };
            } catch (error) {
                console.error('æœç´¢äº¤é€šä¿¡æ¯å¤±è´¥:', error);
                return {
                    flight: `${departure}åˆ°${destination}èˆªç­ä¿¡æ¯`,
                    train: `${departure}åˆ°${destination}ç«è½¦ä¿¡æ¯`,
                    bus: `${departure}åˆ°${destination}é•¿é€”æ±½è½¦ä¿¡æ¯`,
                    localTransport: `${destination}å¸‚å†…äº¤é€šä¿¡æ¯`
                };
            }
        }

        /**
         * è·å–äº¤é€šä¿¡æ¯ï¼ˆåŸºäºè·ç¦»å’ŒåŸå¸‚çº§åˆ«ï¼‰
         */
        function getTransportInfo(departure, destination) {
            const cityInfo = {
                'åŒ—äº¬': { level: 1, hasAirport: true, hasHighSpeed: true },
                'ä¸Šæµ·': { level: 1, hasAirport: true, hasHighSpeed: true },
                'å¹¿å·': { level: 1, hasAirport: true, hasHighSpeed: true },
                'æ·±åœ³': { level: 1, hasAirport: true, hasHighSpeed: true },
                'æ­å·': { level: 2, hasAirport: true, hasHighSpeed: true },
                'å—äº¬': { level: 2, hasAirport: true, hasHighSpeed: true },
                'æˆéƒ½': { level: 2, hasAirport: true, hasHighSpeed: true },
                'é‡åº†': { level: 2, hasAirport: true, hasHighSpeed: true },
                'è¥¿å®‰': { level: 2, hasAirport: true, hasHighSpeed: true },
                'æ­¦æ±‰': { level: 2, hasAirport: true, hasHighSpeed: true },
                'ä¸‰äºš': { level: 3, hasAirport: true, hasHighSpeed: false },
                'æ¡‚æ—': { level: 3, hasAirport: true, hasHighSpeed: true },
                'ä¸½æ±Ÿ': { level: 3, hasAirport: true, hasHighSpeed: false },
                // å®‰å¾½çœåŸå¸‚
                'åˆè‚¥': { level: 2, hasAirport: true, hasHighSpeed: true },
                'èŠœæ¹–': { level: 3, hasAirport: false, hasHighSpeed: true },
                'èšŒåŸ ': { level: 3, hasAirport: false, hasHighSpeed: true },
                'æ·®å—': { level: 3, hasAirport: false, hasHighSpeed: true },
                'é©¬éå±±': { level: 3, hasAirport: false, hasHighSpeed: true },
                'æ·®åŒ—': { level: 3, hasAirport: false, hasHighSpeed: true },
                'é“œé™µ': { level: 3, hasAirport: false, hasHighSpeed: true },
                'å®‰åº†': { level: 3, hasAirport: true, hasHighSpeed: true },
                'é»„å±±': { level: 3, hasAirport: true, hasHighSpeed: true },
                'æ»å·': { level: 3, hasAirport: false, hasHighSpeed: true },
                'é˜œé˜³': { level: 3, hasAirport: true, hasHighSpeed: true },
                'å®¿å·': { level: 3, hasAirport: false, hasHighSpeed: true },
                'å…­å®‰': { level: 3, hasAirport: false, hasHighSpeed: false },
                'äº³å·': { level: 3, hasAirport: false, hasHighSpeed: true },
                'æ± å·': { level: 3, hasAirport: false, hasHighSpeed: true },
                'å®£åŸ': { level: 3, hasAirport: false, hasHighSpeed: true }
            };

            const depInfo = cityInfo[departure] || { level: 3, hasAirport: false, hasHighSpeed: false };
            const destInfo = cityInfo[destination] || { level: 3, hasAirport: false, hasHighSpeed: false };

            let flight = '';
            let train = '';
            let bus = `${departure}åˆ°${destination}é•¿é€”æ±½è½¦å¯è¾¾ï¼Œå»ºè®®æå‰æŸ¥è¯¢ç­æ¬¡`;
            let localTransport = '';

            // èˆªç­ä¿¡æ¯
            if (depInfo.hasAirport && destInfo.hasAirport) {
                if (depInfo.level <= 2 && destInfo.level <= 2) {
                    flight = `${departure}åˆ°${destination}æœ‰ç›´é£èˆªç­ï¼Œé£è¡Œæ—¶é—´çº¦1.5-3å°æ—¶ï¼Œå»ºè®®æå‰é¢„è®¢`;
                } else {
                    flight = `${departure}åˆ°${destination}å¯èƒ½éœ€è¦ä¸­è½¬ï¼Œæ€»è¡Œç¨‹çº¦3-5å°æ—¶`;
                }
            } else {
                flight = `${departure}åˆ°${destination}å»ºè®®é€‰æ‹©å°±è¿‘æœºåœº`;
            }

            // ç«è½¦ä¿¡æ¯
            if (depInfo.hasHighSpeed && destInfo.hasHighSpeed) {
                train = `${departure}åˆ°${destination}æœ‰é«˜é“ç›´è¾¾ï¼Œè¡Œç¨‹çº¦2-6å°æ—¶ï¼Œèˆ’é€‚ä¾¿æ·`;
            } else {
                train = `${departure}åˆ°${destination}æœ‰æ™®é€šåˆ—è½¦ï¼Œè¡Œç¨‹çº¦4-12å°æ—¶`;
            }

            // å½“åœ°äº¤é€š
            if (destInfo.level <= 2) {
                localTransport = `${destination}äº¤é€šå‘è¾¾ï¼Œæœ‰åœ°é“ã€å…¬äº¤ã€å‡ºç§Ÿè½¦ã€ç½‘çº¦è½¦ç­‰å¤šç§é€‰æ‹©`;
            } else {
                localTransport = `${destination}å»ºè®®ä½¿ç”¨å…¬äº¤ã€å‡ºç§Ÿè½¦æˆ–åŒ…è½¦ï¼Œéƒ¨åˆ†æ™¯ç‚¹å¯èƒ½éœ€è¦å¾’æ­¥`;
            }

            return { flight, train, bus, localTransport };
        }

        /**
         * è·å–å¤©æ°”ä¿¡æ¯
         */
        async function getWeatherInfo(destination) {
            try {
                // æ¨¡æ‹Ÿå¤©æ°”ä¿¡æ¯
                const weathers = ['æ™´æœ—', 'å¤šäº‘', 'å°é›¨', 'é˜´å¤©'];
                const temperatures = ['18-25Â°C', '15-22Â°C', '20-28Â°C', '12-18Â°C'];
                
                return {
                    current: `${destination}å½“å‰å¤©æ°”ï¼š${weathers[Math.floor(Math.random() * weathers.length)]}`,
                    forecast: `æœªæ¥å‡ å¤©æ¸©åº¦ï¼š${temperatures[Math.floor(Math.random() * temperatures.length)]}`,
                    suggestion: 'å»ºè®®æºå¸¦é€‚åˆçš„è¡£ç‰©å’Œé›¨å…·'
                };
            } catch (error) {
                console.error('è·å–å¤©æ°”ä¿¡æ¯å¤±è´¥:', error);
                return {
                    current: 'å¤©æ°”ä¿¡æ¯è·å–ä¸­',
                    forecast: 'å¤©æ°”é¢„æŠ¥è·å–ä¸­',
                    suggestion: 'å»ºè®®å…³æ³¨å¤©æ°”å˜åŒ–'
                };
            }
        }

        /**
         * æœç´¢å½“åœ°ç¾é£Ÿ
         */
        async function searchLocalFood(destination) {
            try {
                const foodInfo = getLocalFood(destination);
                return foodInfo;
            } catch (error) {
                console.error('æœç´¢ç¾é£Ÿä¿¡æ¯å¤±è´¥:', error);
                return {
                    specialties: [`${destination}å½“åœ°ç‰¹è‰²ç¾é£Ÿ`],
                    restaurants: [`${destination}æ¨èé¤å…`],
                    streets: [`${destination}ç¾é£ŸåŒºåŸŸ`]
                };
            }
        }

        /**
         * è·å–å½“åœ°ç¾é£Ÿä¿¡æ¯
         */
        function getLocalFood(destination) {
            const foodDB = {
                'åŒ—äº¬': {
                    specialties: ['åŒ—äº¬çƒ¤é¸­', 'ç‚¸é…±é¢', 'è±†æ±ç„¦åœˆ', 'æ¶®ç¾Šè‚‰', 'å¤ç…®ç«çƒ§'],
                    restaurants: ['å…¨èšå¾·', 'ä¾¿å®œåŠ', 'ä¸œæ¥é¡º', 'è€åŒ—äº¬ç‚¸é…±é¢'],
                    streets: ['ç‹åºœäº•å°åƒè¡—', 'å—é”£é¼“å··', 'ç°‹è¡—', 'å‰é—¨å¤§è¡—']
                },
                'ä¸Šæµ·': {
                    specialties: ['å°ç¬¼åŒ…', 'ç”Ÿç…åŒ…', 'çº¢çƒ§è‚‰', 'ç™½åˆ‡é¸¡', 'èŸ¹ç²‰å°ç¬¼'],
                    restaurants: ['é¼æ³°ä¸°', 'å—ç¿”é¦’å¤´åº—', 'è€æ­£å…´', 'æ²ˆå¤§æˆ'],
                    streets: ['åŸéšåº™', 'ç”°å­åŠ', 'æ–°å¤©åœ°', 'æ·®æµ·è·¯']
                },
                'æ­å·': {
                    specialties: ['è¥¿æ¹–é†‹é±¼', 'ä¸œå¡è‚‰', 'é¾™äº•è™¾ä»', 'å«èŠ±é¸¡', 'ç‰‡å„¿å·'],
                    restaurants: ['æ¥¼å¤–æ¥¼', 'çŸ¥å‘³è§‚', 'å¥å…ƒé¦†', 'å¤©å¤–å¤©'],
                    streets: ['æ²³åŠè¡—', 'å—å®‹å¾¡è¡—', 'æ¹–æ»¨é“¶æ³°', 'æ­¦æ—è·¯']
                },
                'æˆéƒ½': {
                    specialties: ['éº»å©†è±†è…', 'å®«ä¿é¸¡ä¸', 'å›é”…è‚‰', 'ç«é”…', 'æ‹…æ‹…é¢'],
                    restaurants: ['é™ˆéº»å©†è±†è…', 'èœ€ä¹é¦™', 'æµ·åº•æ', 'é¾™æŠ„æ‰‹'],
                    streets: ['å®½çª„å··å­', 'é”¦é‡Œ', 'æ˜¥ç†™è·¯', 'å¤ªå¤é‡Œ']
                },
                'è¥¿å®‰': {
                    specialties: ['è‚‰å¤¹é¦', 'å‡‰çš®', 'ç¾Šè‚‰æ³¡é¦', 'èƒ¡è¾£æ±¤', 'biangbiangé¢'],
                    restaurants: ['è€å­™å®¶', 'åŒç››ç¥¥', 'å¾·å‘é•¿', 'è¥¿å®‰é¥­åº„'],
                    streets: ['å›æ°‘è¡—', 'æ°¸å…´åŠ', 'å¤§å”ä¸å¤œåŸ', 'å¤§é›å¡”åŒ—å¹¿åœº']
                },
                'ä¸‰äºš': {
                    specialties: ['æµ·å—é¸¡é¥­', 'æ–‡æ˜Œé¸¡', 'æ¤°å­é¸¡', 'æµ·é²œ', 'æ¸…è¡¥å‡‰'],
                    restaurants: ['æ¤°æ±‡', 'æµ·æ£ 68', 'é˜¿æµªæµ·é²œ', 'ç¬¬ä¸€å¸‚åœº'],
                    streets: ['ç¬¬ä¸€å¸‚åœº', 'æ˜¥å›­æµ·é²œå¹¿åœº', 'å‹è°Šè·¯ä¸‹å²—èŒå·¥æµ·é²œå¹¿åœº']
                },
                'æ¡‚æ—': {
                    specialties: ['æ¡‚æ—ç±³ç²‰', 'å•¤é…’é±¼', 'è”æµ¦èŠ‹æ‰£è‚‰', 'é©¬è¹„ç³•', 'æ­åŸæ²¹èŒ¶'],
                    restaurants: ['å´‡å–„ç±³ç²‰', 'å¤§å¸ˆå‚…å•¤é…’é±¼', 'é˜¿ç”˜é…’å®¶', 'æ­£é˜³æ±¤åŸ'],
                    streets: ['æ­£é˜³æ­¥è¡Œè¡—', 'ä¸œè¥¿å··', 'å°šæ°´ç¾é£Ÿè¡—', 'ä¸­å±±ä¸­è·¯']
                },
                'ä¸½æ±Ÿ': {
                    specialties: ['è…Šæ’éª¨', 'é»‘å±±ç¾Š', 'çº³è¥¿çƒ¤é±¼', 'é¸¡è±†å‡‰ç²‰', 'é…¥æ²¹èŒ¶'],
                    restaurants: ['é˜¿å¦ˆè…Šæ’éª¨', '88å·å°åƒåº—', 'å” å¨åŠ', 'äº‘é›ªä¸½é¤å…'],
                    streets: ['å››æ–¹è¡—', 'å¿ ä¹‰å¸‚åœº', 'æŸæ²³å¤é•‡', 'ç™½æ²™å¤é•‡']
                },
                // å®‰å¾½çœç¾é£Ÿ
                'åˆè‚¥': {
                    specialties: ['åºå·çƒ¤é¸­', 'åŒ…å…¬é±¼', 'ä¸‰æ²³ç±³é¥º', 'å´å±±è´¡é¹…', 'æé¸¿ç« å¤§æ‚çƒ©'],
                    restaurants: ['åŒåº†æ¥¼', 'æ·®ä¸Šæ˜ç ', 'åºå·å¤ªå¤ª', 'è€ä¹¡é¸¡'],
                    streets: ['æ·®æ²³è·¯æ­¥è¡Œè¡—', 'ç½è¡—', 'å®å›½è·¯ç¾é£Ÿè¡—', 'ä¸‰å­å£']
                },
                'èŠœæ¹–': {
                    specialties: ['èŠœæ¹–é¸­è„¯', 'å¼‹æ±Ÿç¾Šè‚‰', 'å¥æ¹–é£˜é±¼ç‰‡', 'è™¾å­é¢', 'å°ç¬¼æ±¤åŒ…'],
                    restaurants: ['é‡‘é™µæ˜¥æ¢¦', 'æ¸…çœŸé©¬å®¶', 'èŠœæ¹–è€¿ç¦å…´', 'åŒç¦èŒ¶æ¥¼'],
                    streets: ['æ­¥è¡Œè¡—', 'é•œæ¹–åŒºç¾é£Ÿè¡—', 'å‡¤å‡°ç¾é£Ÿè¡—', 'ä¸‡è¾¾å¹¿åœº']
                },
                'é»„å±±': {
                    specialties: ['å¾½å·æ¯›è±†è…', 'çŸ³å¤´ç²¿', 'é»„å±±çƒ§é¥¼', 'å¾½å·åˆ€æ¿é¦™', 'é—®æ”¿å±±ç¬‹'],
                    restaurants: ['è€è¡—ç¬¬ä¸€æ¥¼', 'å¾½å·äººå®¶', 'æ±ªä¸€æŒ‘', 'åŒå¾·ä»'],
                    streets: ['å±¯æºªè€è¡—', 'é»é˜³inå··', 'æ–°å®‰æ±Ÿæ»¨æ°´æ—…æ¸¸åŒº']
                },
                'å®‰åº†': {
                    specialties: ['èƒ¡ç‰ç¾èš•è±†é…±', 'æ±Ÿæ¯›æ°´é¥º', 'éŸ¦å®‰æ¸¯èŒ¶å¹²', 'å¤©æŸ±å±±ç“œç‰‡', 'æ¡åŸå°å…°èŠ±'],
                    restaurants: ['è¿æ±Ÿæ¥¼', 'èƒ¡ç‰ç¾', 'æ±Ÿæ¯›æ°´é¥ºåº—', 'éŸ¦å®‰æ¸¯èŒ¶å¹²'],
                    streets: ['å¤§è§‚åŒºç¾é£Ÿè¡—', 'è¿æ±Ÿå¯ºè·¯', 'æ¹–å¿ƒä¸­è·¯']
                },
                'æ± å·': {
                    specialties: ['ä¹åç´ é£Ÿ', 'çŸ³å°åœŸé¸¡', 'ä¸œè‡³äº‘å°–èŒ¶', 'è´µæ± å°æ²³é±¼', 'é’é˜³è±†è…'],
                    restaurants: ['ä¹åå±±åº„', 'ç¥—å›­ç´ é£Ÿ', 'æ± å·å®¾é¦†', 'ä¸œè‡³åœŸèœé¦†'],
                    streets: ['ç¿ å¾®è·¯', 'é’é˜³è·¯', 'ä¹åå±±ç¾é£Ÿè¡—']
                },
                'å…­å®‰': {
                    specialties: ['å…­å®‰ç“œç‰‡', 'éœå±±çŸ³æ–›', 'é‡‘å¯¨æ¿æ —', 'èˆ’åŸè´¡å¸­', 'å¶é›†ç¾Šè‚‰æ±¤'],
                    restaurants: ['çš–è¥¿å®¾é¦†', 'å¾½ç‹åºœ', 'å…­å®‰èŒ¶å¶å¸‚åœº', 'é‡‘å¯¨å†œå®¶ä¹'],
                    streets: ['äººæ°‘è·¯ç¾é£Ÿè¡—', 'è§£æ”¾è·¯', 'æ¢…å±±è·¯']
                },
                'å®£åŸ': {
                    specialties: ['å®£åŸæ¿é¸­', 'æ°´é˜³æ²³èŸ¹', 'ç»©æºªç«è…¿', 'æ³¾å¿å…°é¦™èŒ¶', 'å®å›½å±±æ ¸æ¡ƒ'],
                    restaurants: ['è°¢æœ“æ¥¼', 'æ•¬äº­å±±åº„', 'å®£çº¸æ–‡åŒ–å›­', 'ç»©æºªèƒ¡å®¶å¤§é™¢'],
                    streets: ['çŠ¶å…ƒå—è·¯', 'å®›æºªæ²³ç•”', 'æ•¬äº­å±±è·¯']
                },
                'é“œé™µ': {
                    specialties: ['é“œé™µç™½å§œ', 'é¡ºå®‰é…¥ç³–', 'å¤§é€šèŒ¶å¹²', 'å‡¤ä¸¹', 'é“œé™µé‡é›€èˆŒ'],
                    restaurants: ['å¤©äº•æ¹–å¤§é…’åº—', 'é“œåŒ–å®¾é¦†', 'é‡‘å£å²­å†œå®¶ä¹'],
                    streets: ['é•¿æ±Ÿä¸œè·¯', 'é“œå®˜å¤§é“', 'åŒ—äº¬è·¯']
                },
                'é©¬éå±±': {
                    specialties: ['é‡‡çŸ³èŒ¶å¹²', 'é»„æ± å°é±¼', 'å½“æ¶‚å¤§è‚‰é¢', 'åšæœ›é”…ç›”', 'çŸ³è‡¼æ¹–èŸ¹'],
                    restaurants: ['é‡‡çŸ³çŸ¶èŒ¶å¹²å‚', 'å½“æ¶‚å¤§è‚‰é¢é¦†', 'åšæœ›ç¾é£ŸåŸ'],
                    streets: ['æ¹–å—è·¯ç¾é£Ÿè¡—', 'è§£æ”¾è·¯', 'é›¨å±±è·¯']
                },
                'æ·®å—': {
                    specialties: ['è±†è…å®´', 'å…«å…¬å±±è±†è…', 'æ·®å—ç‰›è‚‰æ±¤', 'ä¸Šçª‘é¦“å­', 'å‡¤å°èŠ±é¼“ç¯'],
                    restaurants: ['å…«å…¬å±±è±†è…æ‘', 'æ·®å—å®¾é¦†', 'å‡¤å°å†œå®¶ä¹'],
                    streets: ['æœé˜³ä¸œè·¯', 'æ´å±±ä¸­è·¯', 'ç”°å®¶åºµåŒºç¾é£Ÿè¡—']
                },
                'èšŒåŸ ': {
                    specialties: ['æ²±æ¹–èƒèŸ¹', 'äº”æ²³æ²±è™¾', 'æ€€è¿œçŸ³æ¦´', 'å›ºé•‡èŠ±ç”Ÿ', 'èšŒåŸ ç‰é›•'],
                    restaurants: ['æ·®æ²³æ˜ç ', 'äº”æ²³å¤§é…’åº—', 'æ€€è¿œå®¾é¦†'],
                    streets: ['æ·®æ²³è·¯', 'èƒœåˆ©è·¯', 'æ¶‚å±±è·¯']
                },
                'é˜œé˜³': {
                    specialties: ['æ ¼æ‹‰æ¡', 'æ•å¤´é¦', 'é˜œé˜³å·é¦', 'å¤ªå’Œæ¿é¢', 'ä¸´æ³‰è´¡æŸ¿'],
                    restaurants: ['é¢å·å®¾é¦†', 'è¥¿æ¹–å¤§é…’åº—', 'å¤ªå’Œæ¿é¢é¦†'],
                    streets: ['é¢å·è·¯', 'äººæ°‘è·¯', 'æ¸…æ²³è·¯']
                },
                'å®¿å·': {
                    specialties: ['è§å¿è‘¡è„', 'ç €å±±é…¥æ¢¨', 'ç¬¦ç¦»é›†çƒ§é¸¡', 'å¤¹æ²Ÿé¦™ç¨»ç±³', 'çµç’§çŸ³'],
                    restaurants: ['ç¬¦ç¦»é›†çƒ§é¸¡åº—', 'è§å¿è‘¡è„å›­', 'ç €å±±æ¢¨å›­'],
                    streets: ['æ·®æ²³è·¯', 'èƒœåˆ©è·¯', 'æ±´æ²³è·¯']
                },
                'äº³å·': {
                    specialties: ['å¤äº•è´¡é…’', 'äº³èŠ', 'åä½—äº”ç¦½æˆèŒ¶', 'æ¶¡é˜³è‹”å¹²', 'è’™åŸç‰›è‚‰å¹²'],
                    restaurants: ['èŠ±æˆæ¥¼é…’åº—', 'å¤äº•è´¡é…’å‚', 'åç¥–åºµç´ é£Ÿ'],
                    streets: ['æ±¤ç‹å¤§é“', 'é­æ­¦å¤§é“', 'è°¯é™µè·¯']
                },
                'æ»å·': {
                    specialties: ['ç…çŠé…¥ç³–', 'æ¥å®‰èŠ±çº¢', 'å¤©é•¿ç”˜éœ²é¥¼', 'æ˜å…‰ç»¿è±†', 'å…¨æ¤’é©¬å‚é…¥ç¬ç‰Œ'],
                    restaurants: ['é†‰ç¿äº­é…’åº—', 'ç…çŠå±±åº„', 'æ˜çš‡é™µå®¾é¦†'],
                    streets: ['å—è°¯è·¯', 'ç…çŠè·¯', 'å‡¤é˜³è·¯']
                }
            };

            return foodDB[destination] || {
                specialties: [`${destination}ç‰¹è‰²ç¾é£Ÿ`, `${destination}åœ°æ–¹å°åƒ`, `${destination}ä¼ ç»Ÿèœè‚´`],
                restaurants: [`${destination}ç‰¹è‰²é¤å…`, `${destination}è€å­—å·`, `${destination}ç½‘çº¢åº—`],
                streets: [`${destination}ç¾é£Ÿè¡—`, `${destination}å°åƒè¡—`, `${destination}å¤œå¸‚`]
            };
        }

        /**
         * ç”Ÿæˆè¯¦ç»†è¡Œç¨‹
         */
        function generateDetailedItinerary(duration, attractions, food) {
            const days = parseInt(duration);
            const itinerary = [];
            
            for (let i = 1; i <= days; i++) {
                let dayPlan = {
                    day: i,
                    title: '',
                    activities: []
                };
                
                if (i === 1) {
                    dayPlan.title = 'æŠµè¾¾ä¸åˆæ¢';
                    dayPlan.activities = [
                        'æŠµè¾¾ç›®çš„åœ°ï¼ŒåŠç†å…¥ä½',
                        'ä¼‘æ•´é€‚åº”ç¯å¢ƒ',
                        'æ¼«æ­¥å‘¨è¾¹ï¼Œç†Ÿæ‚‰å½“åœ°',
                        `å“å°${food.specialties?.[0] || 'å½“åœ°ç‰¹è‰²ç¾é£Ÿ'}`
                    ];
                } else if (i === days && days > 1) {
                    dayPlan.title = 'è¿”ç¨‹å‡†å¤‡';
                    dayPlan.activities = [
                        'æ•´ç†è¡Œæï¼Œè´­ä¹°çºªå¿µå“',
                        'æœ€åçš„æ™¯ç‚¹æ¸¸è§ˆ',
                        'å‰å¾€æœºåœº/è½¦ç«™',
                        'è¿”ç¨‹'
                    ];
                } else {
                    dayPlan.title = `æ·±åº¦æ¸¸è§ˆç¬¬${i-1}å¤©`;
                    dayPlan.activities = [
                        `å‚è§‚${attractions.main?.[Math.min(i-2, attractions.main.length-1)] || 'ä¸»è¦æ™¯ç‚¹'}`,
                        `ä½“éªŒå½“åœ°æ–‡åŒ–æ´»åŠ¨`,
                        `å“å°${food.specialties?.[Math.min(i-2, food.specialties.length-1)] || 'å½“åœ°ç¾é£Ÿ'}`,
                        `è´­ç‰©æˆ–ä¼‘é—²æ´»åŠ¨`
                    ];
                }
                
                itinerary.push(dayPlan);
            }
            
            return itinerary;
        }

        /**
         * ç”Ÿæˆæ™ºèƒ½å»ºè®®
         */
        function generateIntelligentSuggestions(attractions, weather, duration) {
            const suggestions = [
                {
                    title: 'ğŸ¨ ä½å®¿å»ºè®®',
                    content: `å»ºè®®é€‰æ‹©äº¤é€šä¾¿åˆ©çš„å¸‚ä¸­å¿ƒæˆ–æ™¯åŒºé™„è¿‘ä½å®¿ã€‚${duration >= 3 ? 'å»ºè®®æå‰é¢„è®¢ä»¥è·å¾—æ›´å¥½çš„ä»·æ ¼ã€‚' : 'çŸ­æœŸæ—…è¡Œå¯é€‰æ‹©å•†åŠ¡é…’åº—ã€‚'}`
                },
                {
                    title: 'ğŸš— äº¤é€šæŒ‡å—',
                    content: 'æå‰äº†è§£å½“åœ°äº¤é€šæ–¹å¼ï¼Œå»ºè®®ä¸‹è½½å½“åœ°äº¤é€šAPPã€‚æ ¹æ®æ™¯ç‚¹åˆ†å¸ƒé€‰æ‹©æœ€ä½³äº¤é€šæ–¹æ¡ˆã€‚'
                },
                {
                    title: 'ğŸŒ¤ï¸ å¤©æ°”å‡†å¤‡',
                    content: `${weather.suggestion || 'å…³æ³¨å½“åœ°å¤©æ°”é¢„æŠ¥'}ã€‚å»ºè®®æºå¸¦é€‚åˆçš„è¡£ç‰©å’Œå¿…è¦çš„é˜²æŠ¤ç”¨å“ã€‚`
                },
                {
                    title: 'ğŸ’° é¢„ç®—è§„åˆ’',
                    content: `${duration}å¤©è¡Œç¨‹å»ºè®®é¢„ç®—åŒ…å«äº¤é€šã€ä½å®¿ã€é¤é¥®ã€é—¨ç¥¨ç­‰ã€‚å»ºè®®é¢„ç•™10-20%åº”æ€¥èµ„é‡‘ã€‚`
                },
                {
                    title: 'ğŸ“± å®ç”¨å·¥å…·',
                    content: 'æ¨èä¸‹è½½åœ°å›¾ã€ç¿»è¯‘ã€ç‚¹è¯„ç±»APPã€‚ç¡®ä¿æ‰‹æœºç”µé‡å……è¶³ï¼Œå‡†å¤‡å……ç”µå®ã€‚'
                },
                {
                    title: 'ğŸ¯ ç‰¹åˆ«æé†’',
                    content: `${attractions.description || 'äº†è§£å½“åœ°é£ä¿—ä¹ æƒ¯'}ã€‚æ³¨æ„ä¿ç®¡ä¸ªäººè´¢ç‰©ï¼Œè´­ä¹°æ—…è¡Œä¿é™©ã€‚`
                }
            ];
            
            return suggestions;
        }

        /**
         * ç”Ÿæˆé»˜è®¤è§„åˆ’ï¼ˆç½‘ç»œæœç´¢å¤±è´¥æ—¶ä½¿ç”¨ï¼‰
         */
        function generateDefaultPlan(data) {
            return {
                attractions: {
                    main: [`${data.destination}ä¸»è¦æ™¯ç‚¹`],
                    secondary: [`${data.destination}å‘¨è¾¹æ™¯ç‚¹`],
                    description: `${data.destination}æ—…æ¸¸æ¦‚å†µ`
                },
                transportation: {
                    flight: 'èˆªç­ä¿¡æ¯',
                    train: 'ç«è½¦ä¿¡æ¯',
                    bus: 'é•¿é€”æ±½è½¦ä¿¡æ¯',
                    localTransport: 'å½“åœ°äº¤é€šä¿¡æ¯'
                },
                weather: {
                    current: 'å½“å‰å¤©æ°”ä¿¡æ¯',
                    forecast: 'å¤©æ°”é¢„æŠ¥',
                    suggestion: 'å¤©æ°”å»ºè®®'
                },
                localFood: {
                    specialties: [`${data.destination}ç‰¹è‰²ç¾é£Ÿ`],
                    restaurants: [`${data.destination}æ¨èé¤å…`],
                    streets: [`${data.destination}ç¾é£Ÿè¡—`]
                },
                detailedItinerary: [],
                intelligentSuggestions: []
            };
        }

        /**
         * æ¸²æŸ“è§„åˆ’å†…å®¹åˆ°é¡µé¢
         * @param {Object} data - æ—…æ¸¸è§„åˆ’æ•°æ®
         */
        function renderPlanContent(data) {
            // æ¸²æŸ“è¡Œç¨‹æ¦‚è§ˆ
            renderOverview(data);
            
            // æ¸²æŸ“è¯¦ç»†è¡Œç¨‹
            renderItinerary(data);
            
            // æ¸²æŸ“è´´å¿ƒå»ºè®®
            renderSuggestions(data);
        }

        /**
         * æ¸²æŸ“è¡Œç¨‹æ¦‚è§ˆ
         * @param {Object} data - æ—…æ¸¸è§„åˆ’æ•°æ®
         */
        function renderOverview(data) {
            const overviewGrid = document.getElementById('overviewGrid');
            
            const overviewItems = [
                { label: 'å‡ºå‘åœ°', value: data.departure, icon: 'ğŸ“' },
                { label: 'ç›®çš„åœ°', value: data.destination, icon: 'ğŸ¯' },
                { label: 'å‡ºå‘æ—¶é—´', value: data.formattedDate, icon: 'ğŸ“…' },
                { label: 'æ¸¸ç©å¤©æ•°', value: `${data.duration}å¤©`, icon: 'â°' }
            ];
            
            // å¦‚æœæœ‰å¤©æ°”ä¿¡æ¯ï¼Œæ·»åŠ å¤©æ°”æ¦‚è§ˆ
            if (data.weather && data.weather.current) {
                overviewItems.push({
                    label: 'å¤©æ°”çŠ¶å†µ',
                    value: data.weather.current.replace(`${data.destination}å½“å‰å¤©æ°”ï¼š`, ''),
                    icon: 'ğŸŒ¤ï¸'
                });
            }
            
            // å¦‚æœæœ‰äº¤é€šä¿¡æ¯ï¼Œæ·»åŠ æ¨èäº¤é€šæ–¹å¼
            if (data.transportation) {
                let recommendedTransport = 'æŸ¥è¯¢ä¸­';
                if (data.transportation.train && data.transportation.train.includes('é«˜é“')) {
                    recommendedTransport = 'é«˜é“ï¼ˆæ¨èï¼‰';
                } else if (data.transportation.flight && data.transportation.flight.includes('ç›´é£')) {
                    recommendedTransport = 'é£æœºï¼ˆæ¨èï¼‰';
                } else {
                    recommendedTransport = 'å¤šç§æ–¹å¼å¯é€‰';
                }
                
                overviewItems.push({
                    label: 'æ¨èäº¤é€š',
                    value: recommendedTransport,
                    icon: 'ğŸš„'
                });
            }
            
            overviewGrid.innerHTML = overviewItems.map(item => `
                <div class="overview-item">
                    <div class="overview-label">
                        <span class="icon">${item.icon}</span>
                        ${item.label}
                    </div>
                    <div class="overview-value">${item.value}</div>
                </div>
            `).join('');
        }

        /**
         * æ¸²æŸ“è¯¦ç»†è¡Œç¨‹å®‰æ’
         * @param {Object} data - æ—…æ¸¸è§„åˆ’æ•°æ®
         */
        function renderItinerary(data) {
            const itineraryContent = document.getElementById('itineraryContent');
            
            let itineraryHTML = '';
            
            // å¦‚æœæœ‰æ™ºèƒ½ç”Ÿæˆçš„è¯¦ç»†è¡Œç¨‹ï¼Œä½¿ç”¨æ™ºèƒ½è¡Œç¨‹
            if (data.detailedItinerary && data.detailedItinerary.length > 0) {
                data.detailedItinerary.forEach(dayPlan => {
                    const dayIcons = ['ğŸ“…', 'ğŸ—ºï¸', 'ğŸ½ï¸', 'ğŸš¶', 'ğŸ¯', 'âœˆï¸'];
                    const icon = dayIcons[Math.min(dayPlan.day - 1, dayIcons.length - 1)];
                    
                    itineraryHTML += `
                        <div class="itinerary-day">
                            <div class="day-title">${icon} ç¬¬${dayPlan.day}å¤©ï¼š${dayPlan.title}</div>
                            <div class="day-content">
                                ${dayPlan.activities.map(activity => `â€¢ ${activity}`).join('<br>')}
                            </div>
                        </div>
                    `;
                });
            } else {
                // ä½¿ç”¨é»˜è®¤è¡Œç¨‹ç”Ÿæˆé€»è¾‘
                const duration = parseInt(data.duration);
                
                // ç¬¬ä¸€å¤©
                itineraryHTML += `
                    <div class="itinerary-day">
                        <div class="day-title">ğŸ“… ç¬¬1å¤©ï¼šæŠµè¾¾${data.destination}</div>
                        <div class="day-content">
                            â€¢ ä»${data.departure}å‡ºå‘ï¼Œå‰å¾€${data.destination}<br>
                            â€¢ æŠµè¾¾åå…¥ä½é…’åº—ï¼Œä¼‘æ•´é€‚åº”ç¯å¢ƒ<br>
                            â€¢ æ¼«æ­¥å‘¨è¾¹ï¼Œç†Ÿæ‚‰å½“åœ°ç¯å¢ƒ<br>
                            â€¢ å“å°å½“åœ°ç‰¹è‰²æ™šé¤
                        </div>
                    </div>
                `;
                
                // ä¸­é—´å‡ å¤©
                for (let day = 2; day < duration; day++) {
                    const titles = ['ä¸»è¦æ™¯ç‚¹æ¸¸è§ˆ', 'æ·±åº¦ä½“éªŒ', 'å‘¨è¾¹æ¢ç´¢', 'æ–‡åŒ–ä½“éªŒ', 'è‡ªç”±æ´»åŠ¨'];
                    const title = titles[Math.min(day - 2, titles.length - 1)];
                    
                    itineraryHTML += `
                        <div class="itinerary-day">
                            <div class="day-title">ğŸ—ºï¸ ç¬¬${day}å¤©ï¼š${title}</div>
                            <div class="day-content">
                                â€¢ å‚è§‚${data.attractions?.main?.[0] || data.destination + 'ä¸»è¦æ™¯ç‚¹'}<br>
                                â€¢ ä½“éªŒå½“åœ°æ–‡åŒ–æ´»åŠ¨<br>
                                â€¢ å“å°${data.localFood?.specialties?.[0] || 'å½“åœ°ç‰¹è‰²ç¾é£Ÿ'}<br>
                                â€¢ è´­ç‰©æˆ–ä¼‘é—²æ´»åŠ¨
                            </div>
                        </div>
                    `;
                }
                
                // æœ€åä¸€å¤©
                if (duration > 1) {
                    itineraryHTML += `
                        <div class="itinerary-day">
                            <div class="day-title">âœˆï¸ ç¬¬${duration}å¤©ï¼šè¿”ç¨‹å‡†å¤‡</div>
                            <div class="day-content">
                                â€¢ æ•´ç†è¡Œæï¼Œè´­ä¹°æœ€åçš„çºªå¿µå“<br>
                                â€¢ é€€æˆ¿åŠç†ç›¸å…³æ‰‹ç»­<br>
                                â€¢ å‰å¾€æœºåœº/è½¦ç«™<br>
                                â€¢ è¿”å›${data.departure}ï¼Œç»“æŸæ„‰å¿«æ—…ç¨‹
                            </div>
                        </div>
                    `;
                }
            }
            
            itineraryContent.innerHTML = itineraryHTML;
        }

        /**
         * æ¸²æŸ“è´´å¿ƒå»ºè®®
         * @param {Object} data - æ—…æ¸¸è§„åˆ’æ•°æ®
         */
        function renderSuggestions(data) {
            const suggestionsGrid = document.getElementById('suggestionsGrid');
            
            // å¦‚æœæœ‰æ™ºèƒ½ç”Ÿæˆçš„å»ºè®®ï¼Œä½¿ç”¨æ™ºèƒ½å»ºè®®
            let suggestions = [];
            
            if (data.intelligentSuggestions && data.intelligentSuggestions.length > 0) {
                suggestions = data.intelligentSuggestions;
            } else {
                // ä½¿ç”¨é»˜è®¤å»ºè®®
                suggestions = [
                    {
                        title: 'ğŸ¨ ä½å®¿å»ºè®®',
                        content: 'æå‰é¢„è®¢ä½å®¿å¯äº«å—ä¼˜æƒ ä»·æ ¼ï¼Œå»ºè®®é€‰æ‹©äº¤é€šä¾¿åˆ©ã€è¯„ä»·è‰¯å¥½çš„é…’åº—ã€‚æ ¹æ®è¡Œç¨‹å®‰æ’é€‰æ‹©å¸‚ä¸­å¿ƒæˆ–æ™¯åŒºé™„è¿‘çš„ä½å®¿ã€‚'
                    },
                    {
                        title: 'ğŸš— äº¤é€šæŒ‡å—',
                        content: `${data.transportation?.flight || 'äº†è§£èˆªç­ä¿¡æ¯'}ã€‚${data.transportation?.localTransport || 'äº†è§£å½“åœ°äº¤é€šæ–¹å¼'}ã€‚`
                    },
                    {
                        title: 'ğŸŒ¤ï¸ å¤©æ°”å‡†å¤‡',
                        content: `${data.weather?.current || 'å…³æ³¨ç›®çš„åœ°å¤©æ°”é¢„æŠ¥'}ã€‚${data.weather?.suggestion || 'å‡†å¤‡åˆé€‚çš„è¡£ç‰©'}ã€‚`
                    },
                    {
                        title: 'ğŸ’° é¢„ç®—è§„åˆ’',
                        content: 'åˆç†è§„åˆ’æ—…è¡Œé¢„ç®—ï¼ŒåŒ…æ‹¬äº¤é€šã€ä½å®¿ã€é¤é¥®ã€é—¨ç¥¨ç­‰è´¹ç”¨ã€‚å»ºè®®é¢„ç•™åº”æ€¥èµ„é‡‘ï¼Œäº«å—æ— å¿§æ—…ç¨‹ã€‚'
                    },
                    {
                        title: 'ğŸ½ï¸ ç¾é£Ÿæ¨è',
                        content: `æ¨èå“å°ï¼š${data.localFood?.specialties?.join('ã€') || 'å½“åœ°ç‰¹è‰²ç¾é£Ÿ'}ã€‚æ¨èé¤å…ï¼š${data.localFood?.restaurants?.join('ã€') || 'å½“åœ°çŸ¥åé¤å…'}ã€‚`
                    },
                    {
                        title: 'ğŸ¯ æ™¯ç‚¹æ”»ç•¥',
                        content: `ä¸»è¦æ™¯ç‚¹ï¼š${data.attractions?.main?.join('ã€') || 'ä¸»è¦æ—…æ¸¸æ™¯ç‚¹'}ã€‚${data.attractions?.description || 'äº†è§£å½“åœ°é£ä¿—ä¹ æƒ¯'}ã€‚`
                    }
                ];
            }
            
            suggestionsGrid.innerHTML = suggestions.map(suggestion => `
                <div class="suggestion-card">
                    <div class="suggestion-title">${suggestion.title}</div>
                    <div class="suggestion-content">${suggestion.content}</div>
                </div>
            `).join('');
        }

        /**
         * è¿”å›é¦–é¡µ
         */
        function goBack() {
            window.location.href = 'index.html';
        }

        /**
         * ä¿å­˜è§„åˆ’
         */
        function savePlan() {
            const planData = localStorage.getItem('travelPlanData');
            if (planData) {
                const data = JSON.parse(planData);
                const filename = `æ—…æ¸¸è§„åˆ’_${data.departure}åˆ°${data.destination}_${data.formattedDate}.txt`;
                
                let content = `ğŸŒŸ æ™ºèƒ½æ—…æ¸¸è§„åˆ’åŠ©æ‰‹ - æ‚¨çš„ä¸“å±æ—…æ¸¸è§„åˆ’ ğŸŒŸ\n\n`;
                content += `ğŸ“ å‡ºå‘åœ°ï¼š${data.departure}\n`;
                content += `ğŸ¯ ç›®çš„åœ°ï¼š${data.destination}\n`;
                content += `ğŸ“… å‡ºå‘æ—¶é—´ï¼š${data.formattedDate}\n`;
                content += `â° æ¸¸ç©å¤©æ•°ï¼š${data.duration}å¤©\n\n`;
                content += `è¯¦ç»†è§„åˆ’å†…å®¹è¯·æŸ¥çœ‹ç½‘é¡µç‰ˆæœ¬ã€‚\n\n`;
                content += `ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}\n`;
                content += `æ„Ÿè°¢ä½¿ç”¨æ™ºèƒ½æ—…æ¸¸è§„åˆ’åŠ©æ‰‹ï¼`;
                
                downloadTextFile(filename, content);
                alert('è§„åˆ’å·²ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ï¼');
            }
        }

        /**
         * åˆ†äº«è§„åˆ’
         */
        function sharePlan() {
            const planData = localStorage.getItem('travelPlanData');
            if (planData) {
                const data = JSON.parse(planData);
                const shareText = `æˆ‘ç”¨æ™ºèƒ½æ—…æ¸¸è§„åˆ’åŠ©æ‰‹åˆ¶å®šäº†ä»${data.departure}åˆ°${data.destination}çš„${data.duration}å¤©æ—…è¡Œè®¡åˆ’ï¼å‡ºå‘æ—¶é—´ï¼š${data.formattedDate}ã€‚å¿«æ¥ä¸€èµ·è§„åˆ’ä½ çš„æ—…ç¨‹å§ï¼`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'æˆ‘çš„æ—…æ¸¸è§„åˆ’',
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    // å¤åˆ¶åˆ°å‰ªè´´æ¿
                    navigator.clipboard.writeText(shareText).then(() => {
                        alert('è§„åˆ’å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œå¯ä»¥åˆ†äº«ç»™æœ‹å‹äº†ï¼');
                    }).catch(() => {
                        alert('åˆ†äº«å†…å®¹ï¼š' + shareText);
                    });
                }
            }
        }

        /**
         * ä¸‹è½½æ–‡æœ¬æ–‡ä»¶
         * @param {string} filename - æ–‡ä»¶å
         * @param {string} content - æ–‡ä»¶å†…å®¹
         */
        function downloadTextFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }
    </script>
</body>
</html> 